<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talabalar ro'yxati</title>
</head>

<body>

    <h3>Talabalar ro'yxatini olish uchun tugmani bosing</h3>
    <button id="loadBtn">Talabalar</button>

    <ul id="studentList" style="display: none;"></ul>

    <script>
        const loadBtn = document.getElementById('loadBtn');
        const studentList = document.getElementById('studentList');

        let isVisible = false;

        loadBtn.addEventListener('click', function () {
            if (isVisible) {
                studentList.style.display = 'none';
                loadBtn.textContent = "Talabalar";
                isVisible = false;
                return;
            }

            fetch('students.php')
                .then(function (response) {
                    return response.json();
                })
                .then(function (students) {
                    studentList.innerHTML = '';

                    students.forEach(function (student) {
                        const li = document.createElement('li');
                        li.textContent = student.name + ' - ' + student.age + ' yosh';
                        studentList.appendChild(li);
                    });

                    studentList.style.display = 'block';
                    loadBtn.textContent = "Yopish";
                    isVisible = true;
                })
                .catch(function (error) {
                    console.error('Xatolik yuz berdi:', error);
                    studentList.textContent = 'Ma\'lumotlarni yuklashda xatolik!';
                });
        });
    </script>

</body>

</html>